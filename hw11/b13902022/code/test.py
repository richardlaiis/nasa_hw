# source ~/Public/ctf/bin/activate
from pwn import *
from Crypto.Util.number import getStrongPrime, bytes_to_long, long_to_bytes
from math import *
server = remote('140.112.91.4', 11452)

target = bytes_to_long(b"name=soyo")
print(target)

m1 = 0
for i in range(2, int(sqrt(target))):
    if target % i == 0:
        m1 = i
        break
print(m1)

m2 = target//m1
print(m2)

server.sendlineafter(b'> ', b'2')
server.sendlineafter(b':\n', long_to_bytes(m1))
res = server.recvuntil(b'=')
res = res.decode()
tmp1 = int(res.split(' ')[4].rstrip('\n='))

server.sendlineafter(b'> ', b'2')
server.sendlineafter(b':\n', long_to_bytes(m2))
res = server.recvuntil(b'=')
res = res.decode()
tmp2 = int(res.split(' ')[4].rstrip('\n='))

n = 731144044598269461114517956659036418396961977646621677242450291382248324145304225665699124999456691392658820471384409253395116094211904463749789682804012966709926901960805105477124740632788665543828171840261723039232300244162187281733293855614309873028563624868071735360679618087593435251601850414200461978442626838727271613985571929235270123296919219822356385855666032089539592541390515523060322435875803409461159455588392718518300467132183437504308947065080854701276775996745438878472556118526693900075953124248238283036149924024544221154235802836644870085194373241084296226058363533756674427526255286364069479033064458249526057540036439735403255011055826555923291152419863424759950698807838061813869379243394340815130667125417588273310828909487704765707226205187533853210179667437363313325890757297411887235152295765127981312318580337853890182297963156190342364497827270026485204807614506070734066586332173376052962842655022319943621495744918275731722959395498899658980670481687170963514696131200413188787810648324089605302720772589730861028689426312499239231311043391371899817464225984606468986246437991710657070852650737687785280539369987292939698302060214107708747054312387049452746030898582168268838306222500033521838600657173

sig = ((tmp1*tmp2)%n)
print(sig)